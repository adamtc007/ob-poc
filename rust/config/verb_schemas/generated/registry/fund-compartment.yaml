version: '2.0'
domain: fund-compartment
description: |
  Compartment/sleeve management under umbrella funds.

  PURPOSE: Model compartments (sub-funds/sleeves) within umbrella structures without
  creating fake legal entities. Compartments are legally segregated pools within
  a single umbrella but may or may not have separate legal identity.

  KEY CONCEPTS:
  - Compartment: Segregated pool of assets/liabilities within umbrella
  - Ring-fencing: Legal separation of compartment assets from umbrella/other compartments
  - Compartment code: Short identifier (e.g., "EQUITY", "A", "US_GROWTH")
  - Separate NAV: Each compartment has its own Net Asset Value calculation

  TYPICAL USE:
  - SICAV with 5 compartments: "Global Equity", "US Bonds", "Emerging Markets", etc.
  - Each compartment can have multiple share classes with different fee structures
  - Investors buy shares in specific compartments, not the umbrella

  NOTE: Some compartments have their own LEI and act like separate entities;
  others are purely internal accounting segregation. Use compartment_entity_id
  to link to a separate entity when applicable.
verbs:
- verb: fund-compartment.read
  domain: fund-compartment
  action: read
  aliases:
  - fetch
  - get
  - read
  args:
    style: keyworded
    required:
      id:
        type: uuid
  positional_sugar:
  - id
  invocation_phrases:
  - get compartment
  - read sub-fund
  - compartment details
  - read fund-compartment
  - read the fund-compartment
  - get fund-compartment
  - fetch fund-compartment
  - fund-compartment read
  examples:
  - (fund-compartment.read :id "...")
  doc: |
    Read compartment details by ID.
  tier: diagnostics
- verb: fund-compartment.upsert
  domain: fund-compartment
  action: upsert
  aliases:
  - upsert
  args:
    style: keyworded
    required:
      compartment-code:
        type: str
      umbrella-fund-entity-id:
        type: entity_name
    optional:
      compartment-entity-id:
        type: entity_name
      meta:
        type: json
      compartment-name:
        type: str
  positional_sugar:
  - umbrella-fund-entity-id
  - compartment-code
  invocation_phrases:
  - create compartment
  - add sub-fund
  - new sleeve
  - create fund compartment
  - add compartment to umbrella
  - upsert fund-compartment
  - upsert the fund-compartment
  - fund-compartment upsert
  examples:
  - (fund-compartment.upsert :umbrella-fund-entity-id "..." :compartment-code "...")
  doc: |
    Create or update a compartment under an umbrella fund.

    Compartments represent segregated pools within an umbrella structure.
    Each compartment can have its own investors, NAV, and share classes.

    USE CASES:
    - "Create Global Equity compartment under Allianz SICAV"
    - "Add new sleeve to existing umbrella"
    - "Link compartment to its dedicated entity (if separate LEI)"
  tier: intent
- verb: fund-compartment.list-by-umbrella
  domain: fund-compartment
  action: list-by-umbrella
  aliases:
  - list-by-umbrella
  args:
    style: keyworded
    required:
      umbrella-fund-entity-id:
        type: entity_name
  positional_sugar:
  - umbrella-fund-entity-id
  invocation_phrases:
  - list compartments
  - show sub-funds
  - compartments in umbrella
  - all sleeves
  - list by umbrella fund-compartment
  - list by umbrella the fund-compartment
  - fund-compartment list by umbrella
  examples:
  - (fund-compartment.list-by-umbrella :umbrella-fund-entity-id "...")
  doc: |
    List all compartments under an umbrella fund.

    Returns all sleeves/sub-funds within the umbrella structure.
  tier: diagnostics
- verb: fund-compartment.delete
  domain: fund-compartment
  action: delete
  aliases:
  - delete
  - drop
  - remove
  args:
    style: keyworded
    required:
      id:
        type: uuid
  positional_sugar:
  - id
  invocation_phrases:
  - delete compartment
  - remove sub-fund
  - delete sleeve
  - delete fund-compartment
  - delete the fund-compartment
  - remove fund-compartment
  - drop fund-compartment
  - fund-compartment delete
  examples:
  - (fund-compartment.delete :id "...")
  doc: |
    Delete a compartment.

    WARNING: May break share class linkages. Ensure no share classes
    are linked to this compartment before deleting.
  tier: intent
