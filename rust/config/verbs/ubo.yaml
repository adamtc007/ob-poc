domains:
  ubo:
    description: UBO ownership and control chain management
    verbs:
      add-ownership:
        description: Add ownership relationship between entities (idempotent by owner+owned)
        invocation_phrases:
          - "add ownership"
          - "create ownership link"
          - "record ownership"
          - "add owner relationship"
          - "link owner to entity"
          - "set ownership percentage"
          - "create ownership record"
          - "add beneficial owner"
          - "record shareholding"
          - "add ownership stake"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [ownership, relationship, create]
        crud:
          operation: upsert
          table: entity_relationships
          schema: ob-poc
          returning: relationship_id
          conflict_keys:
            - from_entity_id
            - to_entity_id
            - relationship_type
          set_values:
            relationship_type: ownership
        args:
          - name: owner-entity-id
            type: uuid
            required: true
            maps_to: from_entity_id
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: owned-entity-id
            type: uuid
            required: true
            maps_to: to_entity_id
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: percentage
            type: decimal
            required: true
            maps_to: percentage
          - name: ownership-type
            type: string
            required: false
            maps_to: ownership_type
            valid_values:
              - DIRECT
              - INDIRECT
              - BENEFICIAL
              - DIRECTLY_CONSOLIDATED
              - ULTIMATELY_CONSOLIDATED
          - name: interest-type
            type: string
            required: false
            maps_to: interest_type
            default: shareholding
            description: BODS 0.4 interest type code (e.g., shareholding, votingRights, appointmentOfBoard)
            lookup:
              table: bods_interest_types
              entity_type: interest_type
              schema: ob-poc
              search_key: type_code
              primary_key: type_code
          - name: direct-or-indirect
            type: string
            required: false
            maps_to: direct_or_indirect
            description: Whether this is direct or indirect ownership
            valid_values:
              - direct
              - indirect
              - unknown
          - name: effective-from
            type: date
            required: false
            maps_to: effective_from
          - name: evidence-doc-id
            type: uuid
            required: false
            maps_to: source_document_id
            lookup:
              table: document_catalog
              entity_type: document
              schema: ob-poc
              search_key: document_name
              primary_key: doc_id
          - name: notes
            type: string
            required: false
            maps_to: notes
        returns:
          type: uuid
          name: relationship_id
          capture: true
      update-ownership:
        description: Update ownership percentage or end date
        invocation_phrases:
          - "update ownership"
          - "change ownership percentage"
          - "modify ownership"
          - "adjust ownership stake"
          - "update shareholding"
          - "change ownership details"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [ownership, relationship, update]
        crud:
          operation: update
          table: entity_relationships
          schema: ob-poc
          key: relationship_id
        args:
          - name: relationship-id
            type: uuid
            required: true
            maps_to: relationship_id
            lookup:
              table: entity_relationships
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
          - name: percentage
            type: decimal
            required: false
            maps_to: percentage
          - name: effective-to
            type: date
            required: false
            maps_to: effective_to
          - name: notes
            type: string
            required: false
            maps_to: notes
        returns:
          type: affected
      end-ownership:
        description: End an ownership relationship (soft delete - sets effective_to date)
        invocation_phrases:
          - "end ownership"
          - "terminate ownership"
          - "close ownership"
          - "ownership has ended"
          - "sold ownership stake"
          - "ownership disposed"
          - "divested ownership"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [ownership, relationship, lifecycle]
        crud:
          operation: update
          table: entity_relationships
          schema: ob-poc
          key: relationship_id
        args:
          - name: relationship-id
            type: uuid
            required: true
            maps_to: relationship_id
            lookup:
              table: entity_relationships
              entity_type: relationship
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
          - name: effective-to
            type: date
            required: true
            maps_to: effective_to
        returns:
          type: affected

      delete-ownership:
        description: Hard delete an ownership relationship (removes row from entity_relationships)
        invocation_phrases:
          - "delete ownership"
          - "remove ownership record"
          - "hard delete ownership"
          - "erase ownership link"
          - "permanently remove ownership"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [ownership, relationship, delete]
        crud:
          operation: delete
          table: entity_relationships
          schema: ob-poc
          key: relationship_id
        args:
          - name: relationship-id
            type: uuid
            required: true
            maps_to: relationship_id
            lookup:
              table: entity_relationships
              entity_type: relationship
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
        returns:
          type: affected

      add-control:
        description: Add control relationship between entities (board, voting rights, etc.)
        invocation_phrases:
          - "add control"
          - "create control relationship"
          - "add board member"
          - "add controller"
          - "link controller"
          - "add voting control"
          - "create control link"
          - "add executive control"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [control, relationship, create]
        crud:
          operation: upsert
          table: entity_relationships
          schema: ob-poc
          returning: relationship_id
          conflict_keys:
            - from_entity_id
            - to_entity_id
            - relationship_type
            - control_type
          set_values:
            relationship_type: control
        args:
          - name: controller-entity-id
            type: uuid
            required: true
            maps_to: from_entity_id
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: controlled-entity-id
            type: uuid
            required: true
            maps_to: to_entity_id
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: control-type
            type: string
            required: true
            maps_to: control_type
            valid_values:
              - board_member
              - executive
              - voting_rights
              - veto_rights
              - appointee
              - other
          - name: effective-from
            type: date
            required: false
            maps_to: effective_from
          - name: notes
            type: string
            required: false
            maps_to: notes
        returns:
          type: uuid
          name: relationship_id
          capture: true

      end-control:
        description: End a control relationship (soft delete - sets effective_to date)
        invocation_phrases:
          - "end control"
          - "terminate control"
          - "control relationship ended"
          - "remove from board"
          - "end executive control"
          - "control has ceased"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [control, relationship, lifecycle]
        crud:
          operation: update
          table: entity_relationships
          schema: ob-poc
          key: relationship_id
        args:
          - name: relationship-id
            type: uuid
            required: true
            maps_to: relationship_id
            lookup:
              table: entity_relationships
              entity_type: relationship
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
          - name: effective-to
            type: date
            required: true
            maps_to: effective_to
        returns:
          type: affected

      delete-control:
        description: Hard delete a control relationship (removes row from entity_relationships)
        invocation_phrases:
          - "delete control"
          - "remove control record"
          - "hard delete control"
          - "erase control relationship"
          - "permanently remove control"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [control, relationship, delete]
        crud:
          operation: delete
          table: entity_relationships
          schema: ob-poc
          key: relationship_id
        args:
          - name: relationship-id
            type: uuid
            required: true
            maps_to: relationship_id
            lookup:
              table: entity_relationships
              entity_type: relationship
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
        returns:
          type: affected

      add-trust-role:
        description: Add trust role relationship (settlor, trustee, beneficiary, protector)
        invocation_phrases:
          - "add trust role"
          - "add settlor"
          - "add trustee"
          - "add beneficiary"
          - "add protector"
          - "create trust role"
          - "link to trust"
          - "assign trust role"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [trust, relationship, create]
        crud:
          operation: upsert
          table: entity_relationships
          schema: ob-poc
          returning: relationship_id
          conflict_keys:
            - from_entity_id
            - to_entity_id
            - relationship_type
            - trust_role
          set_values:
            relationship_type: trust_role
        args:
          - name: person-entity-id
            type: uuid
            required: true
            maps_to: from_entity_id
            description: The person holding the trust role
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: trust-entity-id
            type: uuid
            required: true
            maps_to: to_entity_id
            description: The trust entity
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: trust-role
            type: string
            required: true
            maps_to: trust_role
            valid_values:
              - settlor
              - trustee
              - beneficiary
              - protector
          - name: trust-interest-type
            type: string
            required: false
            maps_to: trust_interest_type
            description: For beneficiaries - type of interest
            valid_values:
              - fixed
              - discretionary
              - contingent
          - name: effective-from
            type: date
            required: false
            maps_to: effective_from
          - name: notes
            type: string
            required: false
            maps_to: notes
        returns:
          type: uuid
          name: relationship_id
          capture: true

      end-trust-role:
        description: End a trust role relationship (soft delete - sets effective_to date)
        invocation_phrases:
          - "end trust role"
          - "terminate trust role"
          - "remove from trust"
          - "trust role ended"
          - "beneficiary removed"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [trust, relationship, lifecycle]
        crud:
          operation: update
          table: entity_relationships
          schema: ob-poc
          key: relationship_id
        args:
          - name: relationship-id
            type: uuid
            required: true
            maps_to: relationship_id
            lookup:
              table: entity_relationships
              entity_type: relationship
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
          - name: effective-to
            type: date
            required: true
            maps_to: effective_to
        returns:
          type: affected

      delete-trust-role:
        description: Hard delete a trust role relationship (removes row from entity_relationships)
        invocation_phrases:
          - "delete trust role"
          - "remove trust relationship"
          - "hard delete trust role"
          - "erase trust link"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [trust, relationship, delete]
        crud:
          operation: delete
          table: entity_relationships
          schema: ob-poc
          key: relationship_id
        args:
          - name: relationship-id
            type: uuid
            required: true
            maps_to: relationship_id
            lookup:
              table: entity_relationships
              entity_type: relationship
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
        returns:
          type: affected

      delete-relationship:
        description: Hard delete any entity relationship by ID (generic fallback)
        invocation_phrases:
          - "delete relationship"
          - "remove relationship"
          - "hard delete link"
          - "erase relationship"
          - "permanently remove link"
        behavior: crud
        metadata:
          tier: intent
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [relationship, delete, generic]
        crud:
          operation: delete
          table: entity_relationships
          schema: ob-poc
          key: relationship_id
        args:
          - name: relationship-id
            type: uuid
            required: true
            maps_to: relationship_id
            lookup:
              table: entity_relationships
              entity_type: relationship
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
        returns:
          type: affected
      list-owners:
        description: List owners of an entity as of a specific date
        invocation_phrases:
          - "list owners"
          - "show who owns"
          - "view ownership"
          - "who owns this"
          - "display owners"
          - "show shareholders"
          - "list beneficial owners"
          - "find all owners"
        behavior: plugin
        metadata:
          tier: diagnostics
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [ownership, query, temporal]
        args:
          - name: entity-id
            type: uuid
            required: true
            description: Entity to find owners for
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: as-of-date
            type: date
            required: false
            description: Point-in-time date for temporal query (defaults to today)
        returns:
          type: record_set
      list-owned:
        description: List entities owned by an entity (what does this entity own)
        invocation_phrases:
          - "list owned entities"
          - "what do they own"
          - "show holdings"
          - "view owned companies"
          - "list subsidiaries"
          - "show what's owned"
        behavior: crud
        metadata:
          tier: diagnostics
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [ownership, query]
        crud:
          operation: list_by_fk
          table: entity_relationships_current
          schema: ob-poc
          fk_col: from_entity_id
          filter:
            relationship_type: OWNERSHIP
        args:
          - name: entity-id
            type: uuid
            required: true
            maps_to: from_entity_id
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
        returns:
          type: record_set
      list-ubos:
        description: List UBO candidates for a CBU (natural persons with â‰¥25% ownership)
        invocation_phrases:
          - "list UBOs"
          - "show ultimate owners"
          - "find UBO candidates"
          - "who are the UBOs"
          - "display beneficial owners"
          - "show natural person owners"
          - "list ultimate beneficiaries"
          - "find all UBOs"
        behavior: crud
        metadata:
          tier: diagnostics
          source_of_truth: entity
          scope: cbu
          noun: ubo
          tags: [query, ubo-candidates]
        crud:
          operation: list_by_fk
          table: v_ubo_candidates
          schema: ob-poc
          fk_col: cbu_id
        args:
          - name: cbu-id
            type: uuid
            required: true
            lookup:
              table: cbus
              entity_type: cbu
              schema: ob-poc
              search_key: name
              primary_key: cbu_id
        returns:
          type: record_set
      list-by-subject:
        description: List ownership relationships where entity is the owned party
        invocation_phrases:
          - "list by subject"
          - "show owners of"
          - "who owns this entity"
          - "reverse ownership lookup"
          - "find owners by subject"
        behavior: crud
        metadata:
          tier: diagnostics
          source_of_truth: entity
          scope: global
          noun: ubo
          tags: [ownership, query, reverse-lookup]
        crud:
          operation: list_by_fk
          table: entity_relationships_current
          schema: ob-poc
          fk_col: to_entity_id
          filter:
            relationship_type: OWNERSHIP
        args:
          - name: subject-entity-id
            type: uuid
            required: true
            maps_to: to_entity_id
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
        returns:
          type: record_set
      calculate:
        description: Calculate ultimate beneficial ownership chain
        invocation_phrases:
          - "calculate UBO"
          - "compute beneficial ownership"
          - "run UBO calculation"
          - "calculate ownership chain"
          - "determine UBOs"
          - "compute ultimate owners"
          - "find ultimate beneficiaries"
          - "calculate ownership percentages"
        behavior: plugin
        metadata:
          tier: diagnostics
          source_of_truth: entity
          scope: cbu
          noun: ubo
          tags: [computation, ownership, graph-traversal]
        args:
          - name: cbu-id
            type: uuid
            required: true
            lookup:
              table: cbus
              entity_type: cbu
              schema: ob-poc
              search_key: name
              primary_key: cbu_id
          - name: entity-id
            type: uuid
            required: true
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: threshold
            type: decimal
            required: false
            default: 25.0
        returns:
          type: record_set

      trace-chains:
        description: Trace all ownership and control chains to natural persons for a CBU or client
        invocation_phrases:
          - "trace ownership chains"
          - "trace UBO chains"
          - "follow ownership to persons"
          - "trace to natural persons"
          - "map ownership structure"
          - "trace complete chain"
          - "follow all ownership paths"
          - "trace client ownership"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
          noun: ubo
        behavior: plugin
        args:
          # Primary: client nickname for group-level tracing
          - name: client
            type: string
            required: false
            description: Client group nickname (e.g., "Allianz") - traces all CBUs under client
            lookup:
              table: client_group
              entity_type: client_group
              schema: ob-poc
              search_key: alias
              primary_key: id
          # Alternative: specific CBU
          - name: cbu-id
            type: uuid
            required: false
            description: CBU to trace ownership chains for
            lookup:
              table: cbus
              entity_type: cbu
              schema: ob-poc
              search_key: name
              primary_key: cbu_id
          - name: target-entity-id
            type: uuid
            required: false
            description: Optional specific entity to trace from (defaults to CBU's main entity)
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: threshold
            type: decimal
            required: false
            default: 25.0
            description: Minimum ownership percentage to include (default 25%)
          - name: as-of-date
            type: date
            required: false
            description: Point-in-time date for temporal query (defaults to today)
        validation:
          one_of_required: [client, cbu-id]
        returns:
          type: record

      compute-chains:
        description: Compute UBO ownership chains for entities linked to a KYC case
        invocation_phrases:
          - "compute UBO chains"
          - "compute ownership chains"
          - "run UBO determination"
          - "determine UBO chains"
          - "calculate UBO chains"
          - "compute beneficial ownership chains"
          - "run chain computation"
          - "find UBO chains for case"
        behavior: plugin
        metadata:
          tier: intent
          source_of_truth: operational
          scope: global
          noun: ubo
          tags: [computation, ownership, graph-traversal, chain]
        args:
          - name: case-id
            type: uuid
            required: true
            description: KYC case to compute chains for
            lookup:
              table: cases
              entity_type: case
              schema: kyc
              search_key: case_ref
              primary_key: case_id
          - name: threshold
            type: decimal
            required: false
            default: 5.0
            description: Minimum ownership percentage to include (default 5%)
          - name: workstream-id
            type: uuid
            required: false
            description: Optional workstream to narrow computation to a single entity
          - name: config-version
            type: string
            required: false
            description: Config version tag for audit trail
        returns:
          type: record

      # =========================================================================
      # UBO Removal Operations (Convergence Model)
      # These plugin handlers manage lifecycle events that affect UBO status
      # =========================================================================

      mark-deceased:
        description: Mark a person as deceased and cascade effects to ownership/control relationships
        invocation_phrases:
          - "mark as deceased"
          - "person has died"
          - "record death"
          - "update deceased status"
          - "owner is deceased"
          - "mark person deceased"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
          noun: ubo
        behavior: plugin
        args:
          - name: entity-id
            type: uuid
            required: true
            description: The natural person entity to mark as deceased
            lookup:
              table: entities
              entity_type: proper_person
              schema: ob-poc
              search_key: "(search_name (nationality :selectivity 0.7) (date_of_birth :selectivity 0.95 :match-mode year-or-exact))"
              primary_key: entity_id
          - name: date-of-death
            type: date
            required: true
            description: Date of death
          - name: reason
            type: string
            required: false
            description: Documentation reference (e.g., "Death certificate received")
        returns:
          type: record

      convergence-supersede:
        description: Atomically supersede an ownership relationship with a new one in the convergence model
        invocation_phrases:
          - "supersede ownership"
          - "transfer ownership"
          - "replace owner"
          - "ownership changed hands"
          - "new owner replaces old"
          - "supersede relationship"
          - "ownership succession"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
          noun: ubo
        behavior: plugin
        args:
          - name: cbu-id
            type: uuid
            required: true
            description: CBU context for the supersession
            lookup:
              table: cbus
              entity_type: cbu
              schema: ob-poc
              search_key: name
              primary_key: cbu_id
          - name: old-relationship-id
            type: uuid
            required: true
            description: The relationship being superseded
            lookup:
              table: entity_relationships
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
          - name: new-owner-entity-id
            type: uuid
            required: true
            description: The new owner entity
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: percentage
            type: decimal
            required: true
            description: New ownership percentage
          - name: reason
            type: string
            required: true
            description: Reason for supersession (e.g., "Share transfer", "Inheritance")
          - name: effective-date
            type: date
            required: false
            description: Effective date (defaults to today)
        returns:
          type: record

      transfer-control:
        description: Transfer control relationship from one entity to another
        invocation_phrases:
          - "transfer control"
          - "change controller"
          - "control transferred"
          - "new board member"
          - "executive replaced"
          - "transfer board seat"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
          noun: ubo
        behavior: plugin
        args:
          - name: cbu-id
            type: uuid
            required: true
            description: CBU context for the transfer
            lookup:
              table: cbus
              entity_type: cbu
              schema: ob-poc
              search_key: name
              primary_key: cbu_id
          - name: from-entity-id
            type: uuid
            required: true
            description: Entity giving up control
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: to-entity-id
            type: uuid
            required: true
            description: Entity receiving control
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: controlled-entity-id
            type: uuid
            required: true
            description: The entity being controlled
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: control-type
            type: string
            required: true
            description: Type of control relationship
            valid_values:
              - board_member
              - executive
              - voting_rights
              - veto_rights
              - appointee
          - name: reason
            type: string
            required: true
            description: Reason for transfer (e.g., "Board resignation", "Appointment")
          - name: effective-date
            type: date
            required: false
            description: Effective date (defaults to today)
        returns:
          type: record

      waive-verification:
        description: Waive verification requirement for a relationship with documented justification
        invocation_phrases:
          - "waive verification"
          - "skip verification"
          - "waive UBO check"
          - "exempt from verification"
          - "approve waiver"
          - "grant exemption"
          - "low risk waiver"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
          noun: ubo
        behavior: plugin
        args:
          - name: cbu-id
            type: uuid
            required: true
            description: CBU context
            lookup:
              table: cbus
              entity_type: cbu
              schema: ob-poc
              search_key: name
              primary_key: cbu_id
          - name: relationship-id
            type: uuid
            required: true
            description: The relationship whose verification is being waived
            lookup:
              table: entity_relationships
              schema: ob-poc
              search_key: relationship_id
              primary_key: relationship_id
          - name: reason
            type: string
            required: true
            description: Justification for waiver
          - name: approved-by
            type: string
            required: true
            description: Email/ID of approving authority
          - name: waiver-type
            type: string
            required: false
            description: Type of waiver
            valid_values:
              - REGULATORY_EXEMPTION
              - LISTED_COMPANY
              - GOVERNMENT_ENTITY
              - LOW_RISK
              - SENIOR_APPROVAL
        returns:
          type: record

      # =========================================================================
      # UBO Chain Terminus - Mark where ownership chain terminates
      # =========================================================================

      mark-terminus:
        description: Mark an entity as a UBO chain terminus (ownership tracing stops here)
        invocation_phrases:
          - "mark chain terminus"
          - "ownership stops here"
          - "listed company terminus"
          - "public company endpoint"
          - "mark as widely held"
          - "government entity terminus"
          - "chain ends here"
          - "no further tracing"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
          noun: ubo
        behavior: crud
        crud:
          operation: upsert
          table: entity_relationships
          schema: ob-poc
          returning: relationship_id
          conflict_keys:
            - from_entity_id
            - to_entity_id
            - relationship_type
        args:
          - name: entity-id
            type: uuid
            required: true
            description: The entity that is the terminus (e.g., public company, government)
            maps_to: from_entity_id
            lookup:
              table: entities
              entity_type: entity
              schema: ob-poc
              search_key: name
              primary_key: entity_id
          - name: terminus-type
            type: string
            required: true
            description: Why the chain terminates here
            maps_to: control_type
            valid_values:
              - LISTED_COMPANY
              - GOVERNMENT_ENTITY
              - REGULATED_FUND
              - WIDELY_HELD
              - EXCHANGE_TRADED
          - name: exchange
            type: string
            required: false
            description: Stock exchange code if listed (e.g., NYSE, XETRA, LSE)
            maps_to: notes
          - name: lei
            type: string
            required: false
            description: LEI of the public company
          - name: effective-from
            type: date
            required: false
            maps_to: effective_from
        defaults:
          relationship_type: UBO_TERMINUS
          to_entity_id: "00000000-0000-0000-0000-000000000000"
          source: DSL
        returns:
          type: uuid
          name: relationship_id
          capture: true
