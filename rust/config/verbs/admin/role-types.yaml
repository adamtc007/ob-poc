# Admin Verbs - Role Types
# Manage role types reference data at runtime

domains:
  admin.role-types:
    description: "Role types reference data management"
    verbs:
      list:
        description: "List all role types"
        metadata:
          tier: reference
          source_of_truth: operational
          scope: cbu
        behavior: crud
        crud:
          operation: select
          table: role_types
          schema: ob_ref
          multiple: true
        args:
          - name: category
            type: string
            required: false
            maps_to: category
          - name: active-only
            type: boolean
            required: false
            default: true
            maps_to: active
        returns:
          type: record_set

      read:
        description: "Get role type by code"
        metadata:
          tier: reference
          source_of_truth: operational
          scope: cbu
        behavior: crud
        crud:
          operation: select
          table: role_types
          schema: ob_ref
        args:
          - name: code
            type: string
            required: true
            maps_to: code
        returns:
          type: record

      create:
        description: "Create new role type (idempotent by code)"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
        behavior: crud
        crud:
          operation: upsert
          table: role_types
          schema: ob_ref
          returning: role_type_id
          conflict_keys:
            - code
        args:
          - name: code
            type: string
            required: true
            maps_to: code
          - name: name
            type: string
            required: true
            maps_to: name
          - name: category
            type: string
            required: true
            maps_to: category
          - name: triggers-full-kyc
            type: boolean
            required: false
            default: false
            maps_to: triggers_full_kyc
          - name: triggers-screening
            type: boolean
            required: false
            default: false
            maps_to: triggers_screening
          - name: triggers-id-verification
            type: boolean
            required: false
            default: false
            maps_to: triggers_id_verification
          - name: check-regulatory-status
            type: boolean
            required: false
            default: false
            maps_to: check_regulatory_status
          - name: if-regulated-obligation
            type: string
            required: false
            maps_to: if_regulated_obligation
          - name: cascade-to-entity-ubos
            type: boolean
            required: false
            default: false
            maps_to: cascade_to_entity_ubos
          - name: description
            type: string
            required: false
            maps_to: description
        returns:
          type: uuid
          capture: true

      update:
        description: "Update role type"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
        behavior: crud
        crud:
          operation: update
          table: role_types
          schema: ob_ref
        args:
          - name: code
            type: string
            required: true
            maps_to: code
          - name: triggers-full-kyc
            type: boolean
            required: false
            maps_to: triggers_full_kyc
          - name: triggers-screening
            type: boolean
            required: false
            maps_to: triggers_screening
          - name: check-regulatory-status
            type: boolean
            required: false
            maps_to: check_regulatory_status
          - name: if-regulated-obligation
            type: string
            required: false
            maps_to: if_regulated_obligation
          - name: active
            type: boolean
            required: false
            maps_to: active
        returns:
          type: uuid

      deactivate:
        description: "Deactivate a role type"
        metadata:
          tier: intent
          source_of_truth: operational
          scope: cbu
        behavior: crud
        crud:
          operation: update
          table: role_types
          schema: ob_ref
        args:
          - name: code
            type: string
            required: true
            maps_to: code
        computed:
          - column: active
            value: false
        returns:
          type: uuid
