template: request-documents
version: 1

metadata:
  name: Request Documents
  summary: Create document requests for an entity workstream

  description: |
    Creates document request records for required documents
    from an entity. This tracks what documents are needed
    and their collection status.

    Document requirements are often driven by:
    - Role (directors need ID, UBOs need source of wealth)
    - Risk level (high risk needs more documentation)
    - Jurisdiction requirements

  when_to_use:
    - Starting document collection for an entity
    - Workflow blocker shows document requirements
    - Analyst determines additional docs needed

  when_not_to_use:
    - Documents already requested
    - Documents already received

  effects:
    - Document requests created
    - Request status set to REQUIRED
    - Workstream updated with pending requests

  next_steps:
    - Send request to client
    - Catalog documents when received
    - Track outstanding requests

tags:
  - document
  - request
  - collection
  - kyc

workflow_context:
  applicable_workflows:
    - kyc_case
    - kyc_onboarding
  applicable_states:
    - DOCUMENT_COLLECTION
    - ENTITY_COLLECTION
  resolves_blockers:
    - docs_not_requested

params:
  workstream_id:
    type: uuid
    required: true
    prompt: "Entity workstream ID"

  doc_types:
    type: array
    required: true
    prompt: "Document types to request"
    example: "[PASSPORT, PROOF_OF_ADDRESS]"

  due_date:
    type: date
    required: false
    prompt: "Due date for documents"

  priority:
    type: enum
    required: false
    default: "NORMAL"
    enum_values:
      - LOW
      - NORMAL
      - HIGH
      - URGENT

body: |
  (doc-request.create
    :workstream "$workstream_id"
    :doc-types $doc_types
    :due-date "$due_date"
    :priority $priority)

outputs:
  request_ids:
    type: array
    description: Created document request IDs

related_templates:
  - catalog-document
  - verify-document
