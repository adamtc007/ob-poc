# Bacon configuration for ob-poc
# Optimized for development workflow with auto-rebuild on save

[jobs.check]
command = ["cargo", "check", "--color", "always"]
need_stdout = false

[jobs.check-all]
command = ["cargo", "check", "--all-targets", "--features", "visualizer,mock-api,binaries", "--color", "always"]
need_stdout = false

[jobs.clippy]
command = ["cargo", "clippy", "--features", "visualizer,mock-api,binaries", "--color", "always"]
need_stdout = false

[jobs.clippy-all]
command = ["cargo", "clippy", "--all-targets", "--features", "visualizer,mock-api,binaries", "--color", "always"]
need_stdout = false

[jobs.test]
command = ["cargo", "test", "--lib", "--color", "always"]
need_stdout = true

[jobs.test-all]
command = ["cargo", "test", "--color", "always"]
need_stdout = true

[jobs.run-visualizer]
command = ["cargo", "run", "--bin", "egui_visualizer", "--features", "visualizer", "--color", "always"]
need_stdout = true

[jobs.run-mock-api]
command = ["cargo", "run", "--bin", "mock_rest_api_server", "--features", "mock-api", "--color", "always"]
need_stdout = true

[jobs.run-cli]
command = ["cargo", "run", "--bin", "cli", "--features", "database,binaries", "--color", "always"]
need_stdout = true

[jobs.run-example]
command = ["cargo", "run", "--example", "parse_zenith", "--color", "always"]
need_stdout = true

[jobs.doc]
command = ["cargo", "doc", "--features", "visualizer,mock-api", "--color", "always"]
need_stdout = false

[jobs.doc-open]
command = ["cargo", "doc", "--features", "visualizer,mock-api", "--open", "--color", "always"]
need_stdout = false

# Default job - fast check for immediate feedback
default_job = "check"

# File watching configuration - optimized for development workflow
[keybindings]
# Core development keys
c = "job:check"                # Quick check (default)
l = "job:clippy"              # Clippy linting
t = "job:test"                # Run lib tests (fast)
a = "job:check-all"           # Check all targets

# Extended workflow keys
shift-c = "job:clippy-all"    # Full clippy check
shift-t = "job:test-all"      # Run all tests
shift-a = "job:clippy-all"    # Alternative clippy-all

# Run binaries
v = "job:run-visualizer"      # Run visualizer
m = "job:run-mock-api"        # Run mock API
r = "job:run-cli"             # Run CLI (needs DB)
e = "job:run-example"         # Run example

# Documentation
d = "job:doc"                 # Generate docs
shift-d = "job:doc-open"      # Generate and open docs

# Additional settings
[settings]
# Restart on file changes for better responsiveness
on_change_strategy = "restart"
# Watch additional file types
additional_ignores = ["target/", ".git/", "*.tmp", "*.log"]
